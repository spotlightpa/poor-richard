{{ $guide := .Param "guide" }}
{{ $guide := site.GetPage $guide }}
{{ $takeover := .Page.RenderString (.Param "takeover") }}

{{ if $takeover }}
  {{ $takeover }}
  <section class="bg-white px-6 pb-6 pt-16" data-ga-category="header">
    <div
      class="
    mx-auto flex w-full max-w-screen-xl flex-wrap gap-4 md:gap-x-6 lg:gap-x-12
  "
    >
      <div class="md:w-4/6 md:flex-1">
        <div
          class="article-content mt-4 w-full max-w-prose overflow-hidden leading-relaxed"
          data-ga-category="content"
        >
          {{ .Content }}
        </div>
      </div>
      {{ .Page.RenderString (.Param "sidebar") }}
    </div>
  </section>
{{ else }}

  <section class="bg-white px-6 pb-6 pt-16" data-ga-category="header">
    <div
      class="
    mx-auto flex w-full max-w-screen-xl flex-wrap gap-4 md:gap-x-6 lg:gap-x-12
  "
    >
      <h1
        class="w-full pb-2 font-sans text-4xl font-bold leading-tight text-black lg:text-5xl"
      >
        {{ .Title }}
      </h1>
      <div class="md:w-4/6 md:flex-1">
        <h2
          class="mx-auto w-0 min-w-full font-sans text-xl font-semibold md:text-2xl md:leading-tight"
        >
          {{ .Param "dek" }}
        </h2>

        {{ with .Content }}
          <div
            class="article-content mt-4 w-full max-w-prose overflow-hidden leading-relaxed"
            data-ga-category="content"
          >
            {{ . }}
          </div>
        {{ end }}

      </div>
      {{ .Page.RenderString (.Param "sidebar") }}

    </div>
  </section>
{{ end }}


<section class="bg-white px-6 py-6"></section>

<section
  class="sticky top-14 z-20 bg-white p-3 shadow-md md:top-16 lg:block"
  data-ga-category="internal-nav"
  x-data="{ aboutActive: '', isStuck: false }"
  @intersect:about.window="aboutActive = $event.detail"
>
  {{ partial "tw/internal-page-nav.html" . }}

</section>

{{ range $i, $blocks := .Params.blocks }}
  {{ $id := urlize .title }}
  {{ partial "blocks/block" (dict "Page" $ "block" .) }}
{{ end }}


<section class="px-4 md:px-0">
  <div
    id="contact"
    data-ga-category="contact"
    x-data
    x-intersect.half="$dispatch('intersect:about', $el.id)"
    class=" bg-g-3 font-sans md:mx-0 md:px-4"
  >
    {{ .Page.RenderString (.Param "form") }}
  </div>
</section>

<div class="bg-white">
  {{ .Page.RenderString (.Param "donate") }}
</div>

<section
  class="bg-white p-6"
  id="credits"
  data-ga-category="credits"
  x-data
  x-intersect.half="$dispatch('intersect:about', $el.id)"
>
  <div class="mx-auto w-full max-w-prose">
    <h2
      class="w-full border-b border-black font-sans text-2xl font-extrabold capitalize leading-tight tracking-wide md:text-3xl"
    >
      Credits
    </h2>
    <div class="space-y-12 py-8">
      {{ .Page.RenderString (.Param "credits") }}
    </div>
  </div>
</section>

<script src="https://www.spotlightpa.org/embed.js" async></script>
<script
  src="https://viz-redistricting-2020.data.spotlightpa.org/embed.js"
  defer
></script>

{{ range .Param "dates" }}
  <script type="application/ld+json">
    {
      "@context": "https://schema.org",
      "@type": "Event",
      "name": "{{ .name }}",
      "startDate": "{{ .date }}",
      "endDate": "{{ .date }}",
      "eventStatus": "eventScheduled",
      "location": {
        "@type": "Place",
        "name": "Pennsylvania",
        "address": {
          "@type": "PostalAddress",
          "addressRegion": "PA"
        }
      }
    }
  </script>
{{ end }}
