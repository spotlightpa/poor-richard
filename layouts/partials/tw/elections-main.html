{{ $pg := .Paginator 25 }}
{{ $pages := $pg.Pages }}


<section class="bg-white px-6 pt-16 pb-4">
  <h1 class="text-center text-4xl font-semibold leading-none md:text-6xl">
    {{ .Title }}
  </h1>
  <h2
    class="mt-3 text-center text-3xl font-semibold leading-none text-g-6 md:text-4xl"
  >
    {{ .Param "dek" }}
  </h2>
</section>

{{ if eq $pg.PageNumber 1 }}
  {{ $highlights := first 3 $pg.Pages }}
  {{ $pages = after 3 $pg.Pages }}
  <section class="bg-white px-6 py-4">
    <nav class="">
      <ul class="mx-auto flex flex-wrap items-stretch justify-center gap-4">
        {{ range $i, $_ := .Param "links" }}
          {{ $color :=  cond (modBool $i 2)
            "bg-red-6 text-white hover:bg-red-4"
            "bg-navy-6 text-white hover:bg-navy-4"
          }}
          <li class="contents">
            <a
              class="{{ $color }} block whitespace-nowrap rounded-sm p-4 font-sans font-semibold"
              href="{{ .link }}"
            >
              {{- .title -}}
            </a>
          </li>
        {{ end }}
      </ul>
    </nav>
  </section>
  <section
    x-data='{
        url: "https://unpkg.com/add-to-calendar-button@1.14.6/npm_dist/mjs/index.js",
        data(el) {
          return {
            name: el.dataset.name,
            startDate: el.dataset.date,
            endDate: el.dataset.date,
            options: ["Apple", "Google", "Outlook.com"],
            timeZone: "America/New_York",
            listStyle: "modal",
            iCalFileName: el.dataset.name,
          };
        },
      }'
    @mouseover.once="import(url)"
    class="bg-white p-6 text-center"
  >
    <h2
      class="font-sans text-3xl font-bold uppercase leading-none tracking-wide"
    >
      Key Dates
    </h2>
    <ul class="mt-4 flex flex-col gap-3">
      {{ range .Param "dates" }}
        <li class="flex items-center justify-center gap-2 leading-none">
          <span class="text-lg">
            <em class="font-bold not-italic"> {{- .dateVerbose -}} </em>,
            {{ .name }}
          </span>
          <button
            @click.prevent="
              import(url).then((m) => m.atcb_action(data($el), $el))
            "
            class="flex items-baseline gap-1 border-b-4 border-transparent font-sans font-semibold text-g-6 hover:border-yellow"
            type="button"
            data-name="{{ .name }}"
            data-date="{{ .date }}"
          >
            <svg class="inline-block h-4 w-4 fill-current">
              <use href="#calendar-svg" />
            </svg>
            <span>Add to Calendar</span>
          </button>
        </li>
      {{ end }}
    </ul>
  </section>
  {{ range .Param "dates" }}
      <script type="application/ld+json">
        {
          "@context": "https://schema.org",
          "@type": "Event",
          "name": "{{ .name }}",
          "startDate": "{{ .date }}",
          "endDate": "{{ .date }}",
          "location": {
            "@type": "Place",
            "address": {
              "@type": "PostalAddress",
              "addressRegion": "PA"
            }
          }
        }
      </script>
  {{ end }}


  <section class="bg-white p-6">
    <div class="mx-auto max-w-screen-md">
      <h2
        class="border-b-4 border-black pb-2 font-sans text-xl font-extrabold uppercase leading-none tracking-wider"
      >
        Election Coverage from Spotlight&nbsp;PA
      </h2>
    </div>
    <nav class="mx-auto mt-4 grid max-w-screen-md grid-cols-3 justify-between">
      {{ $wrappers := slice "mr-auto" "mx-auto" "ml-auto" }}
      {{ range $i, $page := $highlights }}
        {{ $params := partialCached "helper/page-params" $page $page.RelPermalink }}
        {{ $imgOpts := dict
          "filename" (.Param "image")
          "credit" (.Param "image-credit")
          "description" (.Param "image-description")
          "link" .RelPermalink
          "widthRatio" 16
          "heightRatio" 9
          "widths" (slice 128 256 384 512 1280)
          "figClass" "mt-1"
          "sizeHint" "256px"
        }}
        {{ partial "tw/list-v-item.html" (dict
          "wrapperClass" (index $wrappers $i)
          "imgOpts" $imgOpts
          "rubricLink" .RelPermalink
          "eyebrow" $params.published
          "link" .RelPermalink
          "hed" .LinkTitle
          "dek" (printf "by %s" $params.byline)
          "showDate" false
          )
        }}
      {{ end }}
    </nav>
  </section>

  <section class="bg-white p-6">
    <h2
      class="text-center font-sans text-3xl font-bold uppercase leading-none tracking-wide"
    >
      Follow the money
    </h2>
    <h3
      class="mt-3 text-center font-sans text-lg font-semibold leading-none text-g-6"
    >
      See who is donating in the race for governor
    </h3>
    <div class="mt-8 flex gap-6">
      <div class="mx-auto max-w-screen-sm flex-1">
        <iframe
          src="https://flo.uri.sh/visualisation/11123651/embed"
          title="Interactive or visual content"
          class="flourish-embed-iframe"
          frameborder="0"
          scrolling="no"
          style="display: block; width: 100%; height: 600px;"
          sandbox="allow-same-origin allow-forms allow-scripts allow-downloads allow-popups allow-popups-to-escape-sandbox allow-top-navigation-by-user-activation"
        ></iframe>
      </div>
      <div class="mx-auto max-w-screen-sm flex-1">
        <iframe
          src="https://flo.uri.sh/visualisation/11123875/embed"
          title="Interactive or visual content"
          class="flourish-embed-iframe"
          frameborder="0"
          scrolling="no"
          style="display: block; width: 100%; height: 600px;"
          sandbox="allow-same-origin allow-forms allow-scripts allow-downloads allow-popups allow-popups-to-escape-sandbox allow-top-navigation-by-user-activation"
        ></iframe>
      </div>
    </div>
  </section>

  {{ if .Content }}
    <div class="article-content mx-auto mt-12 max-w-prose leading-relaxed">
      {{ .Content }}
    </div>
  {{ end }}
{{ end }}


<section class="bg-white p-6 text-g-9">
  <nav class="mx-auto mt-12 max-w-prose">
    <h2
      class="font-sans text-xl font-extrabold uppercase leading-none tracking-wider"
    >
      More Election Coverage from Spotlight&nbsp;PA
    </h2>
    <hr class="mt-1 border-2 border-black bg-black" />
    <div class="mt-3 flex flex-col space-y-8 sm:space-y-6" x-ref="archives">
      {{ range $page := $pages }}
        {{ partialCached "tw/list-h-story-date-eyebrow.html" $page $page.RelPermalink }}
      {{ end }}
    </div>
  </nav>

  {{ with $pg }}
    <nav
      class="mx-auto flex max-w-prose items-center justify-between gap-4 py-8 font-sans font-semibold"
      data-ga-category="paginator"
    >
      {{ if .HasPrev }}
        <span>
          <a
            class="
              outline-none inline-block rounded bg-blue-6 px-3 py-1
              uppercase text-white ring-2 ring-transparent
              hover:bg-blue-5 focus:ring-blue-4 active:ring-blue-7
            "
            href="{{ .Prev.URL }}"
          >
            {{- "← Newer" -}}
          </a>
        </span>
      {{ end }}
      {{ if .HasNext }}
        <span>
          <a
            class="
              outline-none inline-block rounded bg-blue-6 px-3 py-1
              uppercase text-white ring-2 ring-transparent
              hover:bg-blue-5 focus:ring-blue-4 active:ring-blue-7
            "
            href="{{ .Next.URL }}"
          >
            {{- "Older →" -}}
          </a>
        </span>
      {{ end }}
    </nav>
  {{ end }}
</section>
