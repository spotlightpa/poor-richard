{{ $news := site.GetPage "/news/_index.md" }}

{{ $topperStories := partial "helper/get-picks" "topper" }}
{{ $topperStory := first 1 $topperStories }}

{{ $featuredStory := partial "helper/get-picks" "featuredStories" }}
{{ $featuredStory = last 1 $featuredStory }}

{{ $subfeatures := partial "helper/get-picks" "subfeatures" }}
{{ $subfeatures = $subfeatures | complement $featuredStory }}

{{ $featuredStories := $featuredStory | append $subfeatures }}

{{ $pinnedStories := partial "helper/get-picks" "topSlots" }}

{{ $editorPicksCallout := partial "helper/get-picks" "edCallout" }}
{{ $edInvestigations := partial "helper/get-picks" "edInvestigations" }}
{{ $edImpact := partial "helper/get-picks" "edImpact" }}
{{ $featuredTopics := partial "helper/get-picks" "featuredTopics" }}
{{ $newsletter := site.GetPage "/newsletters/papost/_index.md" }}

{{ $edNewsletter := "tw/list-callout-newsletter.html" }}

{{ $bureau := site.GetPage "/statecollege/" }}
{{ $paPost := site.GetPage "/newsletters/papost" }}
{{ $river := sort $news.RegularPages ".PublishDate" "desc" }}
{{ $river = $river | complement $featuredStory $pinnedStories $topperStory }}

{{ $hasPromo := .Param "promo-active" }}
{{ $marginClass := cond $hasPromo "has-margin-top-negative" "" }}
{{ if eq (len $featuredStory) 0 }}
  {{ $marginClass = "mt-4" }}
{{ end }}

{{ $edPicks := partial "helper/get-items" "sidebar" }}


<h1 class="sr-only">{{ .Title }}</h1>
{{ partial "tw/frontpage" (dict
  "featuredStories" $featuredStories
  "pinnedStories" $pinnedStories
  "editorPicksCallout" $editorPicksCallout
  "edInvestigations" $edInvestigations
  "edImpact" $edImpact

  "edNewsletter" $edNewsletter
  "newsletter" $newsletter
  "newsletterHed" "Latest From Our Daily Newsletter"
  "bureau" $bureau
  "river" $river
  "edPicks" $edPicks
  "marginClass" $marginClass
  "featuredTopics" $featuredTopics
  )
}}
