{{ with .block }}
  {{ $data := index site.Data.candidates2024 }}

  <script>
    function candidates() {

      let urlParams = new URL(window.location).searchParams.entries();
      let candidateData = {{$data}}

      function paramsToObject() {
        const result = {};
        for (const [key, value] of urlParams) {
          result[key] = value;
        }
        return result;
      }

      let candidateScores = paramsToObject()

      let orderedCandidates = candidateData.map(obj => ({
        name: obj.name,
        id: obj.id,
        points: Number(candidateScores[obj.id]),
        image: obj.image,
        title: obj.title
      }));

      let candidates = [];
      for (let i= 0; i<orderedCandidates.length; i++) {
          if (orderedCandidates[i].points >= 0 ) {
              candidates = [...candidates, orderedCandidates[i]];
          }
      }
      candidates.sort((b, a) => parseFloat(a.points) - parseFloat(b.points));

      // console.log(candidates)
      return candidates;
    }
  </script>
  <div x-data="candidates">
    <template x-for="candidate in candidates">
      <div
        class="mx-auto flex max-w-2xl flex-wrap items-stretch justify-stretch gap-3 px-5 pb-3 lg:px-0"
      >
        <picture class="min-h-full w-7 bg-g-3 md:w-11">
          <img
            class="min-h-full min-w-full object-cover"
            :alt="candidate.imageDescription"
            :title="candidate.imageDescription"
            :src="candidate.image"
            loading="lazy"
          />
        </picture>

        <div class="flex w-3/5 flex-col justify-end">
          <h3
            x-text="candidate.name"
            class="text-xl font-bold leading-none"
          ></h3>
          <p
            x-text="candidate.title"
            class="mt-1 text-base leading-none text-g-8"
          ></p>
        </div>
        <div class="w-full bg-g-3 md:flex-1">
          <span x-text="candidate.points"></span>
        </div>
      </div>
    </template>
  </div>
{{ end }}
