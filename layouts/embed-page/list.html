{{ define "extra-head" }}
  {{ if .Site.IsServer }}
    <script src="http://localhost:1234/embed-list.js" defer></script>
  {{ else }}
    {{ $js := resources.Get "js/embed-list.js" | fingerprint }}
    <script src="{{ $js.RelPermalink }}" defer></script>
  {{ end }}
{{ end }}

{{ define "extra-main" }}
  <section
    class="section columns is-centered is-multiline"
    data-ga-action="Embed list"
  >
    <div class="column is-three-fifths">
      {{ range $page := .Pages }}
        <div class="box has-background-light">
          <h2 class="title is-spaced">{{ .Title }}</h2>

          {{ $params := .Param "page-query-params" }}
          {{ $scriptSrc := absURL "/embed.js" }}
          {{ if .Site.IsServer }}
            {{ $scriptSrc = "http://localhost:1234/embed-host.js" }}
          {{ end }}

          {{ $page := dict "url" .Permalink "title" .Title "params" $params "scriptSrc" $scriptSrc }}
          <script type="application/ld+json" class="js-embed-list-item">
            {{ $page | jsonify | safeJS }}
          </script>

          <h3 class="subtitle is-4">Sample:</h3>
          {{ partial "embed-code.html" $page }}
        </div>
      {{ end }}
    </div>
  </section>
{{ end }}
