<!DOCTYPE html>
<html lang="{{ .Param `language-code` | default site.LanguageCode }}">
  <head itemscope itemtype="http://schema.org/WebSite">
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    {{- with .Param "title-tag" -}}
      <title>{{ . }}</title>
    {{- else -}}
      <title>{{ .Title }} &middot; {{ .Site.Title }}</title>
    {{- end -}}

    {{ partial "header/meta.html" . }}
    {{ partial "header/google-analytics-async.html" . }}

    {{ $cssFonts := resources.Get "css/featured-fonts.css" }}
    {{ $cssTW := resources.Get "css/featured.css" }}
    {{ $css := slice $cssFonts $cssTW | resources.Concat "css/featured-tw.css" }}
    {{ $css = $css | postCSS }}
    {{ if ne hugo.Environment "development" }}
      {{ $css = $css | minify | fingerprint | resources.PostProcess }}
    {{ end }}
    <link rel="stylesheet" href="{{ $css.RelPermalink }}" />
    <link
      rel="preload"
      as="font"
      href="/css/fonts/merriweather-v25/merriweather-v25-latin-700.woff2"
      crossorigin
    />
    <link
      rel="preload"
      as="font"
      href="/css/fonts/merriweather-v25/merriweather-v25-latin-regular.woff2"
      crossorigin
    />

    {{ `<noscript>` | safeHTML }}

    <style>
      .no-js-only {
        display: block;
      }
      .no-js-hide {
         display: none;
      }
    </style>

  {{ `</noscript>` | safeHTML }}

  <script
    nomodule
    src='{{ partialCached "helper/get-nomodules-js" . }}'
    defer
  ></script>
  <script
    src='{{ partialCached "helper/get-enhancements" . }}'
    type="module"
    onerror="Array.from(document.querySelectorAll('script[nomodule]')).forEach(el=>{ let newEl = document.createElement('script'); newEl.src = el.src; document.head.append(newEl); });"
  ></script>
    {{ partial "header/favicons.html" . }}


    <link
      rel="alternate"
      type="application/feed+json"
      href="{{ absURL `/feeds/full.json` }}"
      title="Full News Feed"
    />

    <link
      rel="alternate"
      type="application/rss+xml"
      href="{{ absURL `/feeds/full.xml` }}"
      title="Full News Feed"
    />
  </head>
  {{ $pageCat := printf "%s:%s" (.Section | default .Type) .Kind }}
  {{ if eq .Kind "home" }}{{ $pageCat = "home " }}{{ end }}
  <body
    data-ga-label="{{ $pageCat }}"
    class="bg-beige base-16 font-serif leading-normal"
  >
    {{ block "header" . }}
      <header data-ga-category="header">
        {{ block "nav" . }}
          {{ partialCached "tw/nav.html" . }}
        {{ end }}
        {{ block "banner" . }}
          {{ if .Param "banner-active" }}
            {{ partialCached "tw/banner.html" . }}
          {{ end }}
        {{ end }}
        {{ block "topper" . }}
          {{ if .Param "topper-active" }}
            {{ partialCached "tw/topper.html" . }}
          {{ end }}
        {{ end }}
        {{ block "promo" . }}
          {{ partialCached "tw/promo-header.html" . }}
        {{ end }}
      </header>
    {{ end }}


    <main data-ga-category="main">
      {{ partial "tw/main.html" . }}
    </main>

    <footer
      id="footer"
      data-ga-category="footer"
      data-sf-campaign="701f4000000TVuIAAW"
    >
      {{ partial "tw/footer.html" . }}
    </footer>
    {{ $svgs := dict
      "banner-svg" "/img/logos/banner-default-on-trans.svg"
      "bars-svg" "@fontawesome/solid/bars.svg"
      "close-svg" "@fontawesome/solid/times-circle.svg"
      "email-svg" "@fontawesome/regular/envelope.svg"
      "fb-svg" "@fontawesome/brands/facebook-f.svg"
      "logo-svg" "/img/logos/circle-default-on-trans.svg"
      "search-svg" "@fontawesome/solid/search.svg"
      "share-svg" "@fontawesome/solid/share.svg"
      "spinner-svg" "@fontawesome/solid/spinner.svg"
      "twitter-svg" "@fontawesome/brands/twitter.svg"
    }}
    {{ partialCached "tw/modal-sticky.html" . }}
    {{ partialCached "tw/modal-search.html" . }}
    {{ partialCached "tw/modal-newsletter.html" . }}
    <div hidden>
      {{ range $id, $rsc := $svgs }}
        {{ $svg := resources.Get $rsc }}
        <svg id="{{ $id }}">{{ $svg.Content|safeHTML }}</svg>
      {{ end }}
    </div>
    {{ partial "header/ld-json.html" . }}
  </body>
</html>
