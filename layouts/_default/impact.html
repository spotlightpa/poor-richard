{{ define "main" }}
  <section class="bg-white">
    {{ if .Params.pageTitle }}
      <h1
        class="mx-auto px-4 pt-16 text-4xl font-bold md:w-7/12 md:px-0 lg:text-5xl"
      >
        {{ .Params.pageTitle }}
      </h1>
    {{ end }}


    <div
      data-ga-category="content"
      class="article-content mx-auto w-full px-4 py-6 pb-4 md:w-7/12 md:px-0"
    >
      {{ if .Params.intro }}
        {{ .Params.intro | markdownify }}
      {{ end }}
    </div>

    {{ if .Params.quote }}
      <div class="mx-auto max-w-4xl px-4 py-6">
        <h3 class="flex items-center">
          <span class="flex items-center text-3xl font-bold">
            <svg class="mr-2 h-8 w-8" aria-hidden="true" style="fill: #0cb4eb;">
              {{ partial "helper/svg.html" "quote-left" }}
            </svg>
            {{ .Params.quote }}
            <svg class="mr-2 h-8 w-8" aria-hidden="true" style="fill: #0cb4eb;">
              {{ partial "helper/svg.html" "quote-right" }}
            </svg>
          </span>
        </h3>
        {{ if .Params.quoteSource }}
          <p class="text-gray-500 pb-16 pt-4 text-right font-normal italic">
            {{ .Params.quoteSource }}
          </p>
        {{ end }}
      </div>
    {{ end }}


    <div class="mb-16 h-[500px] w-full bg-beige"></div>

    <div class="mx-auto w-full py-6 pb-4 md:w-7/12">
      {{ if .Params.howHead }}
        <h2 class="mb-4 px-4 text-3xl font-bold md:px-0">
          {{ .Params.howHead }}
        </h2>
      {{ end }}

      {{ if .Params.how }}
        <p
          class="text-gray-700 px-4 pb-16 text-lg font-normal leading-relaxed md:px-0"
        >
          {{ .Params.how }}
        </p>
      {{ end }}
    </div>

    {{ with site.Data.awards }}
      <div class="h-auto w-full bg-beige pb-16">
        <div class="mx-auto flex max-w-4xl items-center px-4 pb-4 pt-16">
          <svg class="mr-4 h-8 w-9" aria-hidden="true" style="fill: #b6b6b6;">
            {{ partial "helper/svg.html" "trophy" }}
          </svg>
          <h2 class="text-4xl font-bold">
            {{ $.Params.awardHead }}
          </h2>
        </div>

        <div class="mx-auto max-w-4xl px-4">
          <div style="border-top: 2.5px solid black; width: 100%;"></div>

          <div class="flex w-full">
            <div
              class="font-bold"
              style="padding: 15px 20px 15px 25px; border-right: 2.5px solid black;"
            >
              <ul class="year-list">
                {{ $years := slice }}
                {{ range . }}
                  {{ $years = $years | append .year }}
                {{ end }}
                {{ $sortedYears := uniq $years | sort }}
                {{ $count := len $sortedYears }}

                {{ range $index := seq 0 (sub $count 1) }}
                  <li>{{ index $sortedYears (sub (sub $count 1) $index) }}</li>
                {{ end }}
              </ul>
            </div>

            {{ $awards := site.Data.awards }}
            <script>
              document.addEventListener("DOMContentLoaded", () => {
                const yearList = document.querySelector(".year-list");
                const awardsContainer =
                  document.querySelector(".awards-container");

                if (!yearList || !awardsContainer) {
                  console.warn("No year list or awards container found.");
                  return;
                }

                const yearItems = yearList.querySelectorAll("li");
                yearItems.forEach((item) => {
                  item.addEventListener("click", () => {
                    const activeYear = item.textContent.trim();

                    yearItems.forEach((li) => li.classList.remove("active"));
                    item.classList.add("active");

                    const awardSections =
                      awardsContainer.querySelectorAll(".award-entity");
                    awardSections.forEach((award) => {
                      const awardYear = award.getAttribute("data-year");
                      award.style.display =
                        awardYear === activeYear ? "block" : "none";
                    });

                    const sections = [
                      {
                        header: ".national-awards-header",
                        container: ".national-awards",
                      },
                      {
                        header: ".national-finalists-header",
                        container: ".national-finalists",
                      },
                      {
                        header: ".state-awards-header",
                        container: ".state-awards",
                      },
                      {
                        header: ".state-finalists-header",
                        container: ".state-finalists",
                      },
                    ];

                    sections.forEach(({ header, container }) => {
                      const section = awardsContainer.querySelector(container);
                      const headerElement =
                        awardsContainer.querySelector(header);
                      const hasVisibleAwards = Array.from(
                        section.querySelectorAll(".award-entity"),
                      ).some((award) => award.style.display === "block");
                      headerElement.style.display = hasVisibleAwards
                        ? "block"
                        : "none";
                    });
                  });
                });

                yearItems[0]?.click();
              });
            </script>

            <div style="padding: 15px 15px 15px 25px;">
              <div class="awards-container">
                <p class="award-national-state national-awards-header">
                  National Awards
                </p>
                <div class="national-awards">
                  {{ range where (where . "national_or_state" "National") "winner_or_finalist_honorable_mention" "Winner" }}
                    <div class="award-entity" data-year="{{ .year }}">
                      {{ .entity }}:
                      <span class="award-category">{{ .award_category }}</span>
                      <p class="award-story">{{ .story }}</p>
                    </div>
                  {{ end }}
                </div>

                <p class="award-national-state national-finalists-header">
                  National Finalists
                </p>
                <div class="national-finalists">
                  {{ range where (where . "national_or_state" "National") "winner_or_finalist_honorable_mention" "Finalist/Honorable Mention" }}
                    <div class="award-entity" data-year="{{ .year }}">
                      {{ .entity }}:
                      <span class="award-category">{{ .award_category }}</span>
                      <p class="award-story">{{ .story }}</p>
                    </div>
                  {{ end }}
                </div>

                <p class="award-national-state state-awards-header">
                  State Awards
                </p>
                <div class="state-awards">
                  {{ range where (where . "national_or_state" "State") "winner_or_finalist_honorable_mention" "Winner" }}
                    <div class="award-entity" data-year="{{ .year }}">
                      {{ .entity }}:
                      <span class="award-category">{{ .award_category }}</span>
                      <p class="award-story">{{ .story }}</p>
                    </div>
                  {{ end }}
                </div>

                <p class="award-national-state state-finalists-header">
                  State Finalists
                </p>
                <div class="state-finalists">
                  {{ range where (where . "national_or_state" "State") "winner_or_finalist_honorable_mention" "Finalist/Honorable Mention" }}
                    <div class="award-entity" data-year="{{ .year }}">
                      {{ .entity }}:
                      <span class="award-category">{{ .award_category }}</span>
                      <p class="award-story">{{ .story }}</p>
                    </div>
                  {{ end }}
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    {{ end }}

  </section>
{{ end }}
